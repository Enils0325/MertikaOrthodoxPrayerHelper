
<Heading HeadingKind="HeadingKindEnum.MainHeading">
    Morning Prayer
</Heading>

<OHeavenlyKingAndTrisagion HeadingKind="HeadingKindEnum.SubHeading" />

@switch (SelectedIndexOutOf3)
{
    case 0:
        <StBasilMorningPrayer HeadingKind="HeadingKindEnum.SubHeading" />
        break;
    case 1:
        <ToTheHolyTrinityMorningPrayer HeadingKind="HeadingKindEnum.SubHeading" />
        break;
    case 2:
        <PhilaretMorningPrayer HeadingKind="HeadingKindEnum.SubHeading" />
        break;
}

<Psalm HeadingKind="HeadingKindEnum.SubHeading" IsBrief="IsBrief" />

<GospelReading HeadingKind="HeadingKindEnum.SubHeading" />

@if (HasNiceneCreed)
{
    <NiceneCreed HeadingKind="HeadingKindEnum.SubHeading" />
}

@if (HasPrayerToMotherOfGod || !IsBrief)
{
    <TrulyMeetTheotokos HeadingKind="HeadingKindEnum.SubHeading" />
}

@if (IsLent && !IsBrief)
{
    <LentStEphremPrayer HeadingKind="HeadingKindEnum.SubHeading" />
}

<ClosingPrayers HeadingKind="HeadingKindEnum.SubHeading" Date=Date />

@code {
    [Parameter, EditorRequired]
    public DateTime Date { get; set; }

    [Parameter]
    public bool IsBrief { get; set; } = false;

    [Parameter]
    public bool HasPrayerToMotherOfGod { get; set; } = false;

    [Parameter]
    public bool HasNiceneCreed { get; set; } = false;

    [Inject]
    public NilsEventService NilsEventService { get; set; } = null!;

    private bool IsLent => false;

    private int SelectedIndexOutOf3 { get; set; } = 0;


    protected override async Task OnParametersSetAsync()
    {
        await OnRandomClicked();
        NilsEventService.OnRandomClicked += OnRandomClicked;
        base.OnParametersSet();
    }


    public async Task OnRandomClicked()
    {
        SelectedIndexOutOf3 = MainUtil.GetRandomIndex(3);
        StateHasChanged();
    }


    public void Dispose()
    {
        NilsEventService.OnRandomClicked -= OnRandomClicked;
    }
}
